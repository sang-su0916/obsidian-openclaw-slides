var m=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var j=(i,e)=>{for(var t in e)m(i,t,{get:e[t],enumerable:!0})},I=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of P(e))!$.call(i,n)&&n!==t&&m(i,n,{get:()=>e[n],enumerable:!(s=x(e,n))||s.enumerable});return i};var D=i=>I(m({},"__esModule",{value:!0}),i);var A={};j(A,{default:()=>h});module.exports=D(A);var a=require("obsidian"),E={gatewayUrl:"http://127.0.0.1:18789",gatewayToken:"",defaultTheme:"brutal",workspacePath:"",autoOpen:!0},d=[{id:"brutal",name:"Neo Brutalism",emoji:"\u{1F3A8}",desc:"\uAD75\uC740 \uD14C\uB450\uB9AC \xB7 \uBE44\uBE44\uB4DC \uCEEC\uB7EC \xB7 \uC624\uD504\uC14B \uADF8\uB9BC\uC790"},{id:"clay",name:"Clay 3D",emoji:"\u{1F9F8}",desc:"\uD30C\uC2A4\uD154 \uB77C\uBCA4\uB354 \xB7 \uAE00\uB798\uC2A4\uBAA8\uD53C\uC998 \xB7 \uD074\uB808\uC774"},{id:"ghibli",name:"Ghibli Pastel",emoji:"\u{1F33F}",desc:"\uC218\uCC44\uD654 \uD14D\uC2A4\uCC98 \xB7 \uB098\uB214\uBA85\uC870 \xB7 \uC138\uD53C\uC544"},{id:"luxury",name:"Corporate Luxury",emoji:"\u{1F451}",desc:"\uBE14\uB799+\uACE8\uB4DC \xB7 Playfair \uC138\uB9AC\uD504 \xB7 VIP"}],w=class extends a.SuggestModal{constructor(e,t){super(e),this.onChoose=t,this.setPlaceholder("\uD14C\uB9C8\uB97C \uC120\uD0DD\uD558\uC138\uC694\u2026")}getSuggestions(e){let t=e.toLowerCase();return d.filter(s=>s.name.toLowerCase().includes(t)||s.id.includes(t)||s.desc.includes(t))}renderSuggestion(e,t){t.createEl("div",{text:`${e.emoji} ${e.name}`,cls:"ocs-theme-title"}),t.createEl("small",{text:e.desc,cls:"ocs-theme-desc"})}onChooseSuggestion(e){this.onChoose(e)}},y=class extends a.Modal{constructor(t,s){super(t);this.dotInterval=null;this.modalEl.addClass("ocs-progress-modal");let{contentEl:n}=this;n.createEl("h3",{text:"\u{1F43E} OpenClaw Slides"}),this.msgEl=n.createEl("p",{text:`${s} \uD14C\uB9C8\uB85C \uAC15\uC758\uC548 \uC0DD\uC131 \uC911`,cls:"ocs-progress-msg"});let r=0;this.dotInterval=window.setInterval(()=>{r=(r+1)%4,this.msgEl.setText(`${s} \uD14C\uB9C8\uB85C \uAC15\uC758\uC548 \uC0DD\uC131 \uC911${".".repeat(r)}`)},500)}setResult(t,s){this.dotInterval&&clearInterval(this.dotInterval),this.msgEl.setText(s),this.msgEl.toggleClass("ocs-success",t),this.msgEl.toggleClass("ocs-error",!t)}onClose(){this.dotInterval&&clearInterval(this.dotInterval),this.contentEl.empty()}},h=class extends a.Plugin{constructor(){super(...arguments);this.settings=E}async onload(){await this.loadSettings(),this.addCommand({id:"generate-slides",name:"\uAC15\uC758\uC548 \uC0DD\uC131 (\uD14C\uB9C8 \uC120\uD0DD)",icon:"presentation",callback:()=>this.promptAndGenerate()}),this.addCommand({id:"generate-slides-default",name:"\uAC15\uC758\uC548 \uC0DD\uC131 (\uAE30\uBCF8 \uD14C\uB9C8)",icon:"presentation",callback:()=>{let t=d.find(s=>s.id===this.settings.defaultTheme)||d[0];this.generate(t)}}),this.addRibbonIcon("presentation","OpenClaw Slides",()=>this.promptAndGenerate()),this.addSettingTab(new T(this.app,this))}promptAndGenerate(){new w(this.app,t=>this.generate(t)).open()}async generate(t){var f,C,S,O;let s=this.app.workspace.getActiveViewOfType(a.MarkdownView);if(!s){new a.Notice("\u274C \uB9C8\uD06C\uB2E4\uC6B4 \uB178\uD2B8\uB97C \uC5F4\uC5B4\uC8FC\uC138\uC694");return}let n=s.editor.getValue().trim();if(!n){new a.Notice("\u274C \uB178\uD2B8 \uB0B4\uC6A9\uC774 \uBE44\uC5B4\uC788\uC2B5\uB2C8\uB2E4");return}if(!this.settings.gatewayToken){new a.Notice("\u274C Settings \u2192 OpenClaw Slides \u2192 Gateway Token\uC744 \uC124\uC815\uD574\uC8FC\uC138\uC694");return}let r=((f=s.file)==null?void 0:f.basename)||"\uAC15\uC758\uC548",k=[`${{brutal:"/slide_brutal",clay:"/slide_clay",ghibli:"/slide_ghibli",luxury:"/slide_luxury"}[t.id]||"/slide"} \uB2E4\uC74C \uB178\uD2B8 \uB0B4\uC6A9\uC744 \uAE30\uBC18\uC73C\uB85C \uAC15\uC758\uC548\uC744 \uB9CC\uB4E4\uC5B4\uC918.`,`\uC81C\uBAA9: "${r}"`,"","\uC0DD\uC131 \uC644\uB8CC \uD6C4 \uBC18\uB4DC\uC2DC \uD30C\uC77C \uACBD\uB85C\uB97C [SLIDE_PATH: \uACBD\uB85C] \uD615\uC2DD\uC73C\uB85C \uC54C\uB824\uC918.","","---","",n].join(`
`),c=new y(this.app,t.name);c.open();try{let o=await(0,a.requestUrl)({url:`${this.settings.gatewayUrl}/v1/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${this.settings.gatewayToken}`,"Content-Type":"application/json"},body:JSON.stringify({model:"openclaw:main",messages:[{role:"user",content:k}],stream:!1}),throw:!1});if(o.status!==200){let p=typeof o.json=="object"?JSON.stringify(o.json):o.text;c.setResult(!1,`\u274C Gateway \uC624\uB958 (${o.status}): ${p}`);return}let g=o.json,b=((O=(S=(C=g==null?void 0:g.choices)==null?void 0:C[0])==null?void 0:S.message)==null?void 0:O.content)||"",v=[/\[SLIDE_PATH:\s*(.+?)\]/,/artifacts\/[^\s\]`"')]+\.html/,/workspace\/artifacts\/[^\s\]`"')]+/],l="";for(let p of v){let u=b.match(p);if(u){l=u[1]||u[0];break}}l?(l.startsWith("/")||(l=`${this.settings.workspacePath||"/Users/isangsu/.openclaw/workspace"}/${l}`),c.setResult(!0,`\u2705 \uC0DD\uC131 \uC644\uB8CC!
\u{1F4C1} ${l}`),this.settings.autoOpen&&window.open(`file://${l}`)):c.setResult(!0,"\u2705 \uC0DD\uC131 \uC644\uB8CC! (\uACBD\uB85C\uB97C \uC790\uB3D9 \uAC10\uC9C0\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4. \uD154\uB808\uADF8\uB7A8\uC5D0\uC11C \uD655\uC778\uD574\uC8FC\uC138\uC694.)"),new a.Notice("\u{1F43E} \uAC15\uC758\uC548 \uC0DD\uC131 \uC644\uB8CC!")}catch(o){let g=o instanceof Error?o.message:String(o);c.setResult(!1,`\u274C \uC5F0\uACB0 \uC2E4\uD328: ${g}`)}}async loadSettings(){this.settings=Object.assign({},E,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},T=class extends a.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"\u{1F43E} OpenClaw Slides"}),e.createEl("p",{text:"OpenClaw AI\uAC00 \uC635\uC2DC\uB514\uC5B8 \uB178\uD2B8\uB97C \uAC15\uC758 \uC2AC\uB77C\uC774\uB4DC(HTML)\uB85C \uBCC0\uD658\uD569\uB2C8\uB2E4.",cls:"setting-item-description"}),e.createEl("h3",{text:"\u{1F517} Gateway \uC5F0\uACB0"}),new a.Setting(e).setName("Gateway URL").setDesc("OpenClaw Gateway HTTP \uC8FC\uC18C (\uAE30\uBCF8: http://127.0.0.1:18789)").addText(s=>s.setPlaceholder("http://127.0.0.1:18789").setValue(this.plugin.settings.gatewayUrl).onChange(async n=>{this.plugin.settings.gatewayUrl=n,await this.plugin.saveSettings()})),new a.Setting(e).setName("Gateway Token").setDesc("\uC778\uC99D \uD1A0\uD070 (openclaw.json \u2192 gateway.auth.token)").addText(s=>{s.inputEl.type="password",s.inputEl.style.width="300px",s.setPlaceholder("your-gateway-token").setValue(this.plugin.settings.gatewayToken).onChange(async n=>{this.plugin.settings.gatewayToken=n,await this.plugin.saveSettings()})}),e.createEl("h3",{text:"\u2699\uFE0F \uC124\uC815"}),new a.Setting(e).setName("\uAE30\uBCF8 \uD14C\uB9C8").setDesc('"\uAE30\uBCF8 \uD14C\uB9C8\uB85C \uC0DD\uC131" \uBA85\uB839\uC5D0\uC11C \uC0AC\uC6A9\uD560 \uD14C\uB9C8').addDropdown(s=>s.addOptions(Object.fromEntries(d.map(n=>[n.id,`${n.emoji} ${n.name}`]))).setValue(this.plugin.settings.defaultTheme).onChange(async n=>{this.plugin.settings.defaultTheme=n,await this.plugin.saveSettings()})),new a.Setting(e).setName("Workspace \uACBD\uB85C").setDesc("OpenClaw workspace \uD3F4\uB354 (\uBE44\uC6CC\uB450\uBA74 \uAE30\uBCF8\uAC12 \uC0AC\uC6A9)").addText(s=>s.setPlaceholder("/Users/isangsu/.openclaw/workspace").setValue(this.plugin.settings.workspacePath).onChange(async n=>{this.plugin.settings.workspacePath=n,await this.plugin.saveSettings()})),new a.Setting(e).setName("\uC790\uB3D9 \uC5F4\uAE30").setDesc("\uC0DD\uC131 \uC644\uB8CC \uD6C4 \uBE0C\uB77C\uC6B0\uC800\uC5D0\uC11C \uC790\uB3D9\uC73C\uB85C \uC5F4\uAE30").addToggle(s=>s.setValue(this.plugin.settings.autoOpen).onChange(async n=>{this.plugin.settings.autoOpen=n,await this.plugin.saveSettings()})),e.createEl("h3",{text:"\u{1F4A1} \uC0AC\uC6A9\uBC95"});let t=e.createDiv({cls:"ocs-help"});t.innerHTML=`
      <ol>
        <li>\uAC15\uC758 \uB0B4\uC6A9\uC744 \uB9C8\uD06C\uB2E4\uC6B4 \uB178\uD2B8\uC5D0 \uC791\uC131</li>
        <li><kbd>Ctrl/Cmd + P</kbd> \u2192 <strong>"\uAC15\uC758\uC548 \uC0DD\uC131"</strong> \uAC80\uC0C9</li>
        <li>\uD14C\uB9C8 \uC120\uD0DD \u2192 AI\uAC00 \uC2AC\uB77C\uC774\uB4DC \uC0DD\uC131</li>
        <li>\uBE0C\uB77C\uC6B0\uC800\uC5D0\uC11C \uACB0\uACFC \uD655\uC778 \u2192 <kbd>Ctrl + P</kbd>\uB85C PDF \uC778\uC1C4</li>
      </ol>
      <p><strong>\uD301:</strong> \uC0AC\uC774\uB4DC\uBC14\uC758 \u{1F3AC} \uC544\uC774\uCF58\uC744 \uD074\uB9AD\uD574\uB3C4 \uB429\uB2C8\uB2E4.</p>
    `}};
